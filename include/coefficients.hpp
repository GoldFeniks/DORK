#pragma once

#include <cmath>
#include <cstddef>
#include <numeric>
#include <type_traits>
#include "utils/types.hpp"

namespace dork::coefficients {

        template<typename T, size_t N, size_t Q = 0, size_t M = 0, size_t K = 0>
        class coefficients {

        public:

            using a_table_t = types::array2d_t<T, N + K>;
            using b_table_t = std::conditional_t<(Q > 0), types::array_t<T, 2, N>, types::array_t<T, 1, N>>;
            using c_table_t = types::array1d_t<T, N + K>;
            using d_table_t = types::array_t<T, N + K, M>;

            static constexpr size_t n = N;
            static constexpr size_t m = M;
            static constexpr size_t k = K;
            static constexpr size_t q = Q;
            static constexpr bool   e = Q > 0;

            coefficients(const a_table_t& a_table, const b_table_t& b_table, const c_table_t& c_table, const d_table_t& d_table) :
                a_table(a_table), b_table(b_table), c_table(c_table), d_table(d_table) {}

            coefficients(const a_table_t& a_table, const b_table_t& b_table, const d_table_t& d_table) :
                a_table(a_table), b_table(b_table), c_table(_make_c_table(a_table)), d_table(d_table) {}

            const a_table_t a_table;
            const b_table_t b_table;
            const c_table_t c_table;
            const d_table_t d_table;

        private:

            static c_table_t _make_c_table(const a_table_t& a_table) {
                c_table_t result;
                for (size_t i = 0; i < result.size(); ++i)
                    result[i] = std::accumulate(a_table[i].begin(), a_table[i].end(), T(0));
                return result;
            }

        };

        template<typename T>
        static coefficients<T, 2, 2> rkf1 = coefficients<T, 2, 2>(
            {
                T(0), T(0),
                T(1), T(0)
            },
            {
                T(1),        T(0),
                T(1) / T(2), T(1) / T(2)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 3, 2> rkf1b = coefficients<T, 3, 2>(
            {
                T(0),          T(0),            T(0),
                T(1) / T(2),   T(0),            T(0),
                T(1) / T(256), T(255) / T(256), T(0)
            },
            {
                T(1) / T(256), T(255) / T(256), T(0),
                T(1) / T(512), T(255) / T(256), T(1) / T(512)
            }
        );

        template<typename T>
        static coefficients<T, 2> rk2 = coefficients<T, 2>(
            { T(0), T(0),  T(1) / T(2), T(0)  },
            { T(0), T(1) },
            {}
        );

        template<typename T>
        static coefficients<T, 4> rk4 = coefficients<T, 4>(
            {
                T(0),        T(0),        T(0), T(0),
                T(1) / T(2), T(0),        T(0), T(0),
                T(0),        T(1) / T(2), T(0), T(0),
                T(0),        T(0),        T(1), T(0)
            },
            {
                T(1) / T(6), T(1) / T(3), T(1) / T(3), T(1) / T(6)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 4, 0, 3> rk4_do3 = coefficients<T, 4, 0, 3>(
            rk4<T>.a_table,
            rk4<T>.b_table,
            rk4<T>.c_table,
            {
                T(1), -T(3) / T(2),  T(2) / T(3),
                T(0),  T(1),        -T(2) / T(3),
                T(0),  T(1),        -T(2) / T(3),
                T(0), -T(1) / T(2),  T(2) / T(3)
            }
        );

        template<typename T>
        static coefficients<T, 7, 4> dopri5 = coefficients<T, 7, 4>(
            {
                T(0),                T(0),               T(0),                T(0),             T(0),               T(0),          T(0),
                T(1)     / T(5),     T(0),               T(0),                T(0),             T(0),               T(0),          T(0),
                T(3)     / T(40),    T(9)     / T(40),   T(0),                T(0),             T(0),               T(0),          T(0),
                T(44)    / T(45),   -T(56)    / T(15),   T(32)    / T(9),     T(0),             T(0),               T(0),          T(0),
                T(19372) / T(6561), -T(25360) / T(2187), T(64448) / T(6561), -T(212) / T(729),  T(0),               T(0),          T(0),
                T(9017)  / T(3168), -T(355)   / T(33),   T(46732) / T(5247),  T(49)  / T(176), -T(5103) / T(18656), T(0),          T(0),
                T(35)    / T(384),   T(0),               T(500)   / T(1113),  T(125) / T(192), -T(2187) / T(6784),  T(11) / T(84), T(0),
            },
            {
                T(35)   / T(384),   T(0), T(500)  / T(1113),  T(125) / T(192), -T(2187)  / T(6784),   T(11)  / T(84),   T(0),
                T(5179) / T(57600), T(0), T(7571) / T(16695), T(393) / T(640), -T(92097) / T(339200), T(187) / T(2100), T(1) / T(40)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 7, 4, 5> dopri5_do5 = coefficients<T, 7, 4, 5>(
            dopri5<T>.a_table,
            dopri5<T>.b_table,
            dopri5<T>.c_table,
            {
                T(1), -T(4034104133)   / T(1410260304),   T(105330401)  / T(33982176),  -T(13107642775)  / T(11282082432),   T(6542295)     / T(470086768),
                T(0),  T(0),                              T(0),                          T(0),                               T(0),
                T(0),  T(132343189600) / T(32700410799), -T(833316000)  / T(131326951),  T(91412856700)  / T(32700410799),  -T(523383600)   / T(10900136933),
                T(0), -T(115792950)    / T(29380423),     T(185270875)  / T(16991088),  -T(12653452475)  / T(1880347072),    T(98134425)    / T(235043384),
                T(0),  T(70805911779)  / T(24914598704), -T(4531260609) / T(600351776),  T(988140236175) / T(199316789632), -T(14307999165) / T(24914598704),
                T(0), -T(331320693)    / T(205662961),    T(31361737)   / T(7433601),   -T(2426908385)   / T(822651844),     T(97305120)    / T(205662961),
                T(0),  T(44764047)     / T(29380423),    -T(1532549)    / T(353981),     T(90730570)     / T(29380423),     -T(8293050)     / T(29380423)
            }
        );

        template<typename T>
        static coefficients<T, 6, 4> fehlberg4 = coefficients<T, 6, 4>(
            {
                T(0),               T(0),               T(0),               T(0),               T(0),          T(0),
                T(1)    / T(4),     T(0),               T(0),               T(0),               T(0),          T(0),
                T(3)    / T(32),    T(9)    / T(32),    T(0),               T(0),               T(0),          T(0),
                T(1932) / T(2197), -T(7200) / T(2197),  T(7296) / T(2197),  T(0),               T(0),          T(0),
                T(439)  / T(216),  -T(8),               T(3680) / T(513),  -T(845)  / T(4104),  T(0),          T(0),
               -T(8)    / T(27),    T(2),              -T(3544) / T(2565),  T(1859) / T(4104), -T(11) / T(40), T(0)
            },
            {
                T(25) / T(216), T(0), T(1408) / T(2565),  T(2197)  / T(4104),  -T(1) / T(5),  T(0),
                T(16) / T(135), T(0), T(6656) / T(12825), T(28516) / T(56430), -T(9) / T(50), T(2) / T(55)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 13, 7> fehlberg7 = coefficients<T, 13, 7>(
            {
                T(0),              T(0),          T(0),           T(0),             T(0),               T(0),            T(0),               T(0),           T(0),           T(0),          T(0), T(0), T(0),
                T(2)    / T(27),   T(0),          T(0),           T(0),             T(0),               T(0),            T(0),               T(0),           T(0),           T(0),          T(0), T(0), T(0),
                T(1)    / T(36),   T(1) / T(12),  T(0),           T(0),             T(0),               T(0),            T(0),               T(0),           T(0),           T(0),          T(0), T(0), T(0),
                T(1)    / T(24),   T(0),          T(1)  / T(8),   T(0),             T(0),               T(0),            T(0),               T(0),           T(0),           T(0),          T(0), T(0), T(0),
                T(5)    / T(12),   T(0),         -T(25) / T(16),  T(25)  / T(16),   T(0),               T(0),            T(0),               T(0),           T(0),           T(0),          T(0), T(0), T(0),
                T(1)    / T(20),   T(0),          T(0),           T(1)   / T(4),    T(1)    / T(5),     T(0),            T(0),               T(0),           T(0),           T(0),          T(0), T(0), T(0),
               -T(25)   / T(108),  T(0),          T(0),           T(125) / T(108), -T(65)   / T(27),    T(125) / T(54),  T(0),               T(0),           T(0),           T(0),          T(0), T(0), T(0),
                T(31)   / T(300),  T(0),          T(0),           T(0),             T(61)   / T(225),  -T(2)   / T(9),   T(13)   / T(900),   T(0),           T(0),           T(0),          T(0), T(0), T(0),
                T(2),              T(0),          T(0),          -T(53)  / T(6),    T(704)  / T(45),   -T(107) / T(9),   T(67)   / T(90),    T(3),           T(0),           T(0),          T(0), T(0), T(0),
               -T(91)   / T(108),  T(0),          T(0),           T(23)  / T(108), -T(976)  / T(135),   T(311) / T(54), -T(19)   / T(60),    T(17) / T(6),  -T(1)  / T(12),  T(0),          T(0), T(0), T(0),
                T(2383) / T(4100), T(0),          T(0),          -T(341) / T(164),  T(4496) / T(1025), -T(301) / T(82),  T(2133) / T(4100),  T(45) / T(82),  T(45) / T(164), T(18) / T(41), T(0), T(0), T(0),
                T(3)    / T(205),  T(0),          T(0),           T(0),             T(0),              -T(6)   / T(41), -T(3)    / T(205),  -T(3)  / T(41),  T(3)  / T(41),  T(6)  / T(41), T(0), T(0), T(0),
               -T(1777) / T(4100), T(0),          T(0)           -T(341) / T(164),  T(4496) / T(1025), -T(289) / T(82),  T(2193) / T(4100),  T(51) / T(82),  T(33) / T(164), T(12) / T(41), T(0), T(1), T(0)
            },
            {
                T(41) / T(840), T(0), T(0), T(0), T(0), T(34) / T(105), T(9) / T(35), T(9) / T(35), T(9) / T(280), T(9) / T(280), T(41) / T(840), T(0),           T(0),
                T(0),           T(0), T(0), T(0), T(0), T(34) / T(105), T(9) / T(35), T(9) / T(35), T(9) / T(280), T(9) / T(280), T(0),           T(41) / T(840), T(41) / T(810)
            },
            {}
        );

        namespace {

            template<typename T>
            static const T sq6 = std::sqrt(T(6));

        }// namespace

        template<typename T>
        static coefficients<T, 12, 6> dop853 = coefficients<T, 12, 6>(
            {
                T(0),                                                 T(0),                     T(0),                                 T(0),                                                                  T(0),                                                                  T(0),                            T(0),                                  T(0),                                 T(0),                                         T(0),                         T(0),                          T(0),
                T(2) * (T(6)   -           sq6<T>) / T(135),          T(0),                     T(0),                                 T(0),                                                                  T(0),                                                                  T(0),                            T(0),                                  T(0),                                 T(0),                                         T(0),                         T(0),                          T(0),
                       (T(6)   -           sq6<T>) / T(180),         (T(6) - sq6<T>) / T(60),   T(0),                                 T(0),                                                                  T(0),                                                                  T(0),                            T(0),                                  T(0),                                 T(0),                                         T(0),                         T(0),                          T(0),
                      -(T(6)   -           sq6<T>) / T(15),           T(0),                    (T(6)   -          sq6<T>) / T(10),    T(0),                                                                  T(0),                                                                  T(0),                            T(0),                                  T(0),                                 T(0),                                         T(0),                         T(0),                          T(0),
                       (T(492) +  T(107) * sq6<T>) / T(3000),         T(0),                   -(T(402) + T(197) * sq6<T>) / T(1000),           (T(168)         + T(73)         * sq6<T>) / T(375),           T(0),                                                                  T(0),                            T(0),                                  T(0),                                 T(0),                                         T(0),                         T(0),                          T(0),
                T(1)                               / T(27),           T(0),                     T(0),                                          (T(16)          +                 sq6<T>) / T(108),                    (T(16)          -                 sq6<T>) / T(108),           T(0),                            T(0),                                  T(0),                                 T(0),                                         T(0),                         T(0),                          T(0),
                T(19)                              / T(512),          T(0),                     T(0),                                          (T(118)         + T(23)         * sq6<T>) / T(1024),                   (T(118)         - T(23)         * sq6<T>) / T(1024),         -T(9)           / T(512),         T(0),                                  T(0),                                 T(0),                                         T(0),                         T(0),                          T(0),
                T(13772)                           / T(371293),       T(0),                     T(0),                                 T(8)   * (T(6443)        + T(598)        * sq6<T>) / T(371293),        T(8)   * (T(6443)        - T(598)        * sq6<T>) / T(371293),       -T(5688)        / T(371293),      T(3072)           / T(371293),         T(0),                                 T(0),                                         T(0),                         T(0),                          T(0),
                T(58656157643)                     / T(93983540625),  T(0),                     T(0),                                -T(127) * (T(10432202552) + T(2510247597) * sq6<T>) / T(626556937500), -T(127) * (T(10432202552) - T(2510247597) * sq6<T>) / T(626556937500),  T(96044563816) / T(3480871875),  T(5682451879168)  / T(281950621875),  -T(165125654)      / T(3796875),       T(0),                                         T(0),                         T(0),                          T(0),
                T(8909899)                         / T(18653125),     T(0),                     T(0),                                -T(3)   * (T(1507136)     + T(379321)     * sq6<T>) / T(2937500),      -T(3)   * (T(1507136)     - T(379321)     * sq6<T>) / T(2937500),       T(96663078)    / T(4553125),     T(2107245056)     / T(137915625),     -T(4913652016)     / T(147609375),    -T(78894270)          / T(3880452869),         T(0),                         T(0),                          T(0),
               -T(20401265806)                     / T(21769653311),  T(0),                     T(0),                                 T(6)   * (T(59036)       + T(15721)      * sq6<T>) / T(112847),        T(6)   * (T(59036)       - T(15721)      * sq6<T>) / T(112847),       -T(43306765128) / T(5313852383), -T(20866708358144) / T(1126708119789),  T(14886003438020) / T(654632330667),  T(35290686222309375) / T(14152473387134411), -T(1477884375) / T(485066827), T(0),                          T(0),
                T(39815761)                        / T(17514443),     T(0),                     T(0),                                -T(5)   * (T(691496)      + T(192181)     * sq6<T>) / T(551636),       -T(5)   * (T(691496)      - T(192181)     * sq6<T>) / T(551636),       -T(844554132)   / T(47026969),    T(8444996352)     / T(302158619),     -T(2509602342)     / T(877790785),    -T(28388795297996250) / T(3199510091356783),   T(226716250)  / T(18341897),  T(1371316744) / T(2131383595), T(0)
            },
            {
                T(104257) / T(1920240),     T(0), T(0), T(0), T(0), T(3399327) / T(763840), T(66578432)  / T(35198415),  -T(1674902723)  / T(288716400),   T(54980371265625) / T(176692375811392), -T(734375)   / T(4826304),  T(171414593)  / T(851261400),   T(137909) / T(3084480),
                T(13131403) / T(207385920), T(0), T(0), T(0), T(0), T(2),                   T(359635072) / T(316785735), -T(47038053413) / T(17322984000), T(307828315925)   / T(5699754058432),    T(13481525) / T(65155104), T(8823427697) / T(41789196000), T(137909) / T(3084480)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 12, 6, 7, 4> dop853_do7 = coefficients<T, 12, 6, 7, 4>(
            {
                T(0),                                                    T(0),                     T(0),                                 T(0),                                                                  T(0),                                                                  T(0),                                 T(0),                                    T(0),                                        T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                T(2) * (T(6)   -           sq6<T>) / T(135),             T(0),                     T(0),                                 T(0),                                                                  T(0),                                                                  T(0),                                 T(0),                                    T(0),                                        T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                       (T(6)   -           sq6<T>) / T(180),            (T(6) - sq6<T>) / T(60),   T(0),                                 T(0),                                                                  T(0),                                                                  T(0),                                 T(0),                                    T(0),                                        T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                      -(T(6)   -           sq6<T>) / T(15),              T(0),                    (T(6)   -          sq6<T>) / T(10),    T(0),                                                                  T(0),                                                                  T(0),                                 T(0),                                    T(0),                                        T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                       (T(492) +  T(107) * sq6<T>) / T(3000),            T(0),                   -(T(402) + T(197) * sq6<T>) / T(1000),           (T(168)         + T(73)         * sq6<T>) / T(375),           T(0),                                                                  T(0),                                 T(0),                                    T(0),                                        T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                T(1)                               / T(27),              T(0),                     T(0),                                          (T(16)          +                 sq6<T>) / T(108),                    (T(16)          -                 sq6<T>) / T(108),           T(0),                                 T(0),                                    T(0),                                        T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                T(19)                              / T(512),             T(0),                     T(0),                                          (T(118)         + T(23)         * sq6<T>) / T(1024),                   (T(118)         - T(23)         * sq6<T>) / T(1024),         -T(9)            / T(512),             T(0),                                    T(0),                                        T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                T(13772)                           / T(371293),          T(0),                     T(0),                                 T(8)   * (T(6443)        + T(598)        * sq6<T>) / T(371293),        T(8)   * (T(6443)        - T(598)        * sq6<T>) / T(371293),       -T(5688)         / T(371293),          T(3072)           / T(371293),           T(0),                                        T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                T(58656157643)                     / T(93983540625),     T(0),                     T(0),                                -T(127) * (T(10432202552) + T(2510247597) * sq6<T>) / T(626556937500), -T(127) * (T(10432202552) - T(2510247597) * sq6<T>) / T(626556937500),  T(96044563816)  / T(3480871875),      T(5682451879168)  / T(281950621875),    -T(165125654)        / T(3796875),            T(0),                                         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                T(8909899)                         / T(18653125),        T(0),                     T(0),                                -T(3)   * (T(1507136)     + T(379321)     * sq6<T>) / T(2937500),      -T(3)   * (T(1507136)     - T(379321)     * sq6<T>) / T(2937500),       T(96663078)     / T(4553125),         T(2107245056)     / T(137915625),       -T(4913652016)       / T(147609375),         -T(78894270)          / T(3880452869),         T(0),                          T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
               -T(20401265806)                     / T(21769653311),     T(0),                     T(0),                                 T(6)   * (T(59036)       + T(15721)      * sq6<T>) / T(112847),        T(6)   * (T(59036)       - T(15721)      * sq6<T>) / T(112847),       -T(43306765128)  / T(5313852383),     -T(20866708358144) / T(1126708119789),    T(14886003438020)   / T(654632330667),       T(35290686222309375) / T(14152473387134411), -T(1477884375) / T(485066827),  T(0),                                    T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                T(39815761)                        / T(17514443),        T(0),                     T(0),                                -T(5)   * (T(691496)      + T(192181)     * sq6<T>) / T(551636),       -T(5)   * (T(691496)      - T(192181)     * sq6<T>) / T(551636),       -T(844554132)    / T(47026969),        T(8444996352)     / T(302158619),       -T(2509602342)       / T(877790785),         -T(28388795297996250) / T(3199510091356783),   T(226716250)  / T(18341897),   T(1371316744)    / T(2131383595),        T(0),                               T(0),                               T(0),                              T(0),                             T(0),
                T(104257)                          / T(1920240),         T(0),                     T(0),                                 T(0),                                                                  T(0),                                                                  T(3399327)      / T(763840),          T(66578432)       / T(35198415),        -T(1674902723)       / T(288716400),          T(54980371265625)    / T(176692375811392),   -T(734375)     / T(4826304),    T(171414593)     / T(851261400),         T(137909)     / T(3084480),         T(0),                               T(0),                              T(0),                             T(0),
                T(13481885573)                     / T(240030000000),    T(0),                     T(0),                                 T(0),                                                                  T(0),                                                                  T(0),                                 T(139418837528)   / T(549975234375),    -T(11108320068443)   / T(45111937500000),    -T(1769651421925959)  / T(14249385146080000),  T(57799439)   / T(377055000),  T(793322643029)  / T(96734250000000),    T(1458939311) / T(192780000000),   -T(4149)        / T(500000),         T(0),                              T(0),                             T(0),
                T(1595561272731)                   / T(50120273500000),  T(0),                     T(0),                                 T(0),                                                                  T(0),                                                                  T(975183916491) / T(34457688031250),  T(38492013932672) / T(718912673015625), -T(1114881286517557) / T(20298710767500000),  T(0),                                         T(0),                         -T(2538710946863) / T(23431227861250000), T(8824659001) / T(23066716781250), -T(11518334563) / T(33831184612500), T(1912306948)   / T(13532473845),  T(0),                             T(0),
               -T(13613986967)                     / T(31741908048),     T(0),                     T(0),                                 T(0),                                                                  T(0),                                                                 -T(4755612631)   / T(1012344804),      T(42939257944576) / T(5588559685701),    T(77881972900277)   / T(19140370552944),     T(22719829234375)    / T(63689648654052),     T(0),                          T(0),                                    T(0),                              -T(1199007803)  / T(857031517296),   T(157882067000) / T(53564469831), -T(290468882375) / T(31741908048), T(0)
            },
            dop853<T>.b_table,
            {
                T(1), -T(3243165325)         / T(315911484),           T(45644645435)        / T(947734452),        -T(145234679965)        / T(1263645936),        T(232928595811)    / T(1579557420),                    -T(8761295365)             / T(90260424),           T(450944925)           / T(17550638),
                T(0),  T(0),                                           T(0),                                         T(0),                                          T(0),                                                   T(0),                                              T(0),
                T(0),  T(0),                                           T(0),                                         T(0),                                          T(0),                                                   T(0),                                              T(0),
                T(0),  T(0),                                           T(0),                                         T(0),                                          T(0),                                                   T(0),                                              T(0),
                T(0),  T(0),                                           T(0),                                         T(0),                                          T(0),                                                   T(0),                                              T(0),
                T(0),  T(1499103207)         / T(107712352),          -T(8336282913)         / T(53856176),          T(3633880563)          / T(6949184),          -T(122861875761)    / T(269280880),                     -T(2033930655)             / T(26928088),           T(14532122925)         / T(94248308),
                T(0),  T(1231700992)         / T(472712319),          -T(214648864768)       / T(9926958699),        T(133156864)           / T(52523591),          T(4835325202432)   / T(16544931165),                   -T(5017184189440)          / T(9926958699),         T(595876966400)        / T(2573655959),
                T(0), -T(101911388761)       / T(6785522820),          T(651794836589)       / T(4071313692),       -T(225854190263)        / T(476177040),         T(4612810937813)   / T(33927614100),                    T(4438621054621)          / T(8142627384),        -T(188748653015)        / T(527762886),
                T(0),  T(380037013965984375) / T(124580745831017888), -T(141230476250296875) / T(3664139583265232),  T(1402308203204390625) / T(8037467472968896), -T(56545784859375)  / T(62290372915508944) * T(371293),  T(18175700132377734375ul) / T(62290372915508944), -T(2545485458115234375) / T(27252038150535163),
                T(0), -T(215171875)          / T(162042336),           T(28349078125)        / T(1701444528),       -T(1269734375)          / T(17057088),          T(79827296875)     / T(567148176),                     -T(5636328125)             / T(47262348),           T(1376953125)          / T(36759604),
                T(0),  T(199183757066)       / T(70023343995),        -T(3071920921153)      / T(84028012794),       T(95618316852667)      / T(560186751960),     -T(242263158334981) / T(700233439950),                   T(5850208644497)          / T(18672891732),       -T(53995596795)         / T(518691437),
                T(0),  T(111016745)          / T(144985248),          -T(126738371)          / T(12792816),          T(4523828927)          / T(96656832),         -T(34984893029)     / T(362463120),                      T(19299675005)            / T(217477872),         -T(210311225)           / T(7047894),
                T(0), -T(1547917)            / T(1421424),             T(30056749)           / T(2132136),          -T(15797305)            / T(236904),            T(98051953)        / T(710712),                        -T(545068475)              / T(4264272),            T(1718875)             / T(39484),
                T(0),  T(98350000)           / T(5419179),            -T(2075000000)         / T(16257537),          T(645500000)           / T(1806393),          -T(2713400000)      / T(5419179),                        T(5676650000)             / T(16257537),          -T(58000000)            / T(602131),
                T(0), -T(18878125)           / T(2053168),             T(287515625)          / T(3079752),          -T(290140625)           / T(1026584),           T(370740625)       / T(1026584),                       -T(1243309375)             / T(6159504),            T(1546875)             / T(39484),
                T(0), -T(1944542619)         / T(438351368),           T(12423141963)        / T(219175684),        -T(14343592590)         / T(54793921),          T(114184881819)    / T(219175684),                     -T(28879389675)            / T(62621624),           T(1262172375)          / T(8429834),
            }
        );

        template<typename T>
        static coefficients<T, 8, 5> dverk6 = coefficients<T, 8, 5>(
            {
                T(0),                T(0),            T(0),                  T(0),             T(0),                T(0), T(0),               T(0),
                T(1)    / T(6),      T(0),            T(0),                  T(0),             T(0),                T(0), T(0),               T(0),
                T(4)    / T(75),     T(16) / T(75),   T(0),                  T(0),             T(0),                T(0), T(0),               T(0),
                T(5)    / T(6),     -T(8)  / T(3),    T(5)      / T(2),      T(0),             T(0),                T(0), T(0),               T(0),
               -T(165)  / T(64),     T(55) / T(6),   -T(425)    / T(64),     T(85)  / T(96),   T(0),                T(0), T(0),               T(0),
                T(12)   / T(5),     -T(8),            T(4015)   / T(612),   -T(11)  / T(36),   T(88)    / T(255),   T(0), T(0),               T(0),
               -T(8263) / T(15000),  T(124) / T(75), -T(643)    / T(680),   -T(81)  / T(250),  T(2484)  / T(10625), T(0), T(0),               T(0),
                T(3501) / T(1720),  -T(300) / T(43),  T(297275) / T(52623), -T(319) / T(2322), T(24068) / T(84065), T(0), T(3850) / T(26703), T(0)
            },
            {
                T(3)  / T(40),  T(0), T(875)  / T(2244), T(23) / T(72), T(264) / T(1955), T(0),         T(125) / T(11592), T(43) / T(616),
                T(13) / T(160), T(0), T(2375) / T(5984), T(5)  / T(16), T(12)  / T(85),   T(3) / T(44), T(0),              T(0)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 4, 2> ceschino2 = coefficients<T, 4, 2>(
            {
                T(0),         T(0),        T(0), T(0),
                T(1) / T(4),  T(0),        T(0), T(0),
                T(0),         T(1) / T(2), T(0), T(0),
                T(1),         T(2),        T(2), T(0)
            },
            {
                T(1),        -T(2), T(2),        T(0),
                T(1) / T(6),  T(0), T(4) / T(6), T(1) / T(6)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 5, 3> merson4 = coefficients<T, 5, 3>(
            {
                T(0),        T(0),         T(0),        T(0),  
                T(1) / T(3), T(0),         T(0),        T(0),
                T(1) / T(6), T(1) / T(6),  T(0),        T(0),
                T(1) / T(8), T(0),         T(3) / T(8), T(0),
                T(1) / T(2), T(0),        -T(3) / T(2), T(2),
            },
            {
                T(1) / T(2), T(0), -T(3) / T(2), T(2),        T(0),
                T(1) / T(6), T(0),  T(0),        T(2) / T(3), T(1) / T(6)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 5, 3> zonneveld4 = coefficients<T, 5, 3>(
            {
                T(0),         T(0),         T(0),           T(0),         T(0),
                T(1) / T(2),  T(0),         T(0),           T(0),         T(0),
                T(0),         T(1) / T(2),  T(0),           T(0),         T(0),
                T(0),         T(0),         T(1),           T(0),         T(0),
                T(5) / T(32), T(7) / T(32), T(13) / T(32), -T(1) / T(32), T(0),
            },
            {
                T(1) / T(6), T(1) / T(3), T(1) / T(3), T(1)  / T(6),  T(0),
               -T(1) / T(2), T(7) / T(3), T(7) / T(3), T(13) / T(6), -T(16) / T(3)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 3, 2> rkf2 = coefficients<T, 3, 2>(
            {
                T(0),        T(0),        T(0),
                T(1),        T(0),        T(0),
                T(1) / T(4), T(1) / T(4), T(0)
            },
            {
                T(1) / T(2), T(1) / T(2), T(0),
                T(1) / T(6), T(1) / T(6), T(4) / T(6)
            },
            {}
        );

        template<typename T>
        static coefficients<T, 4, 2> rkf2b = coefficients<T, 3, 2>(
            {
                T(0),            T(0),            T(0),            T(0),
                T(1)   / T(4),   T(0),            T(0),            T(0),
               -T(189) / T(800), T(729) / T(800), T(0),            T(0),
                T(214) / T(891), T(1)   / T(33),  T(650) / T(891), T(0)
            },
            {
                T(214) / T(891),  T(1) / T(33), T(650) / T(891),   T(0),
                T(533) / T(2106), T(0),         T(800) / T(1053), -T(1) / T(78)
            },
            {}
        );

}// namespace dork::coefficients
